#!/usr/bin/env bash
BIN_DIR=~/.bin
INSTALL_DIR=${BIN_DIR}/MQTT-Connect
TEMPDL_DIR=${BIN_DIR}/.temp-dl
OLD_PWD=$(pwd)
REPO_URL="https://github.com/pdxlocations/Meshtastic-MQTT-Connect"

# TODO: Purger le soft si le mot clé purge est passé en argument
if [[ "$#" == "1" && "$1" == "purge" ]]; then
	echo "Déinstallation..."
	rm -rf ${INSTALL_DIR}
	rm -f ~/.local/share/applications/${INSTALL_DIR##*/}.desktop
	exit 0
fi

# Ne pas relancer si le soft existe deja
if [ -d ${INSTALL_DIR} ]; then
	echo "Logiciel déjà installé. Pour désinstaller, lancer: $0 purge"
	exit 0
fi

# Préparatifs spécifiques Debian
grep Debian /etc/os-release &> /dev/null
if [[ "$?" == "0" ]]; then
	echo "Debian détecté, installation des prérequis. Votre mot de passe peut être demandé."
	sudo apt update
	sudo apt install -y git python3-venv python3-pip 
fi

# Télécharger le logiciel
mkdir -p ${TEMPDL_DIR}
cd ${TEMPDL_DIR}
git clone "$REPO_URL"
mv ${REPO_URL##*/} ${INSTALL_DIR}
cd ${INSTALL_DIR}
rm -rf ${TEMPDL_DIR}

# Installer les fichiers supplementaires
cat > ${INSTALL_DIR}/launch.sh <<EOF
#!/usr/bin/env bash
cd ${INSTALL_DIR}
source .venv/bin/activate
\$(which python3) ./meshtastic-mqtt-connect.py
EOF

cat > ~/.local/share/applications/${INSTALL_DIR##*/}.desktop <<EOF
[Desktop Entry]
Name=MQTT Connect
Exec=${INSTALL_DIR}/launch.sh
Type=Application
Icon=${INSTALL_DIR}/icon.png
EOF

echo "H4sICJW1bWYAA2ljb24ucG5nAO2791dTW9Q2CiFgEJHQexdQekc6KIggRaX3gBQh9N4hoKB0RKoUGzUEAtJrUDoISgm9Cwih9xa4+7zv+e6/cO8Y38kY2T+svZ8115r1mcleb5/qapDfZLpJQEBArvlY7TkBAcjkny+EBBhpdcicISDgINBUUzUIsNqana75I52OWnx/r9Tn81iFvZaph92bvkjxAmse09+usbri3PfmojwJNbU76rqL+wzcqCxOx7lEKz0W9azbwvC4OHYwVIWA8J8LwhYcxoWOrTSAgiAcEQTAZTeXAMED/X/vfwdDyr6r0MYQ/HsfamL7v3eAy13tCAz/LQPPf5ERAJDkP+B/wP+A/wH/A/4H/A/4/3sgYgl8dW60pNf5xJDjn2GV24QggW5jQfV/MVAQ2OjNl8y3/2JkgSlYrCtp/pX3AJiDM9HW4SYhruK5QqcuMLrwGATGpvikJfyLYNeMwJw/rkP6yIJCu7RWS1n0eTiB4TNgohD2UlVf8BvUhsV3jn+QdgCyF6MonKDCl96Yv22B9KzdOHa/Ph0PDz07s24LOcu/vjpJwh13jM3tjJyi69hA8Moj5+aE5daKxfoy435UDN0T6P1sAoSvpM2KzCPYVOXlwcn1iT/+akc5PORs/vpSltp2mUjD92kC8UPisSy9Zyffi2VcFUTrHbdDOMTYDeJ3pISsEMtZUJUIzE0PKmo4l6iP2gtPqVqPHgeUr5bU2GuhMzBWXMe8ZqpPzjVNrC0P3ZdEL3U/FRDJ6zp0kwc9oHCkH2VOy1RlOkvbX9L5FDpQno15ftfXcwrvMzJxEtYYsBXmxjjhOXAcvnOVE37VK2kztoip7yeFmmQ0RRAygqMH7fQsEnDe/Q6KqfY9H9v7siFlZEjFZ0cTCwt5E1xo51hQ7ahGBKZ0iE+wNBFz3IjU0M51+LbKiuXmqSdBKILqGEIfXe6kBSi7vUUqhoUl/Y8HTPDsmh07W22eT5XNxjQRIOTB0RMzZtSnwq2+n8bS5PLFQ040tzU+CgHGNr8y+EBE+r7ntqA8kojc6LAbel/L4ojA3XMaNRLkY7zU/dH4GVgaWG8kEaKN/pP/3VWcaWIv1CX/Q00dx9wzinx69EloWHV9dmxZGGXIdQUcR4aSvWxmMFyWAoHT61VghjCdIhUtu4rVjxlrDkegivyghjrU3OHAGni79q/SEwshdWwLN0vhzuDaqaYOZSYVB1oNDKIG9Q9uQjylwv54uWK512hN7S4ZEU1+x6Nb84N0xoo7No6beT30X/Ipvzg3qEdgqJjZdWFKeHG20PzxFMVaaWR+0LrrKCL00a4wPqT67/yyXO5SXpuEuEnw5eWVBODE+YuONSGxGHT0n03Bdrw70yAxVj/Ny1MQsZJd+G3ZK9EtMHk7u1ic4A25bDQ9pwqMtr042QW0fNvl9MLQNNKmO11bxc8ireqqxXtCy1RMxFGuRueSvdO0oQFwc4v5yua7iMYqMI5sIc7IxEYMXE6PNy+uLbr5YkGcBvEDEB/zydCDBHEktGKs1364WbhGYQ+1t3cCdbPQPv/et3VQqU2RvoCMdwHMU3ttYh2v0mIa2Y1toiH69LEUMipQXhgVoTHYXXpT8AX0fg7gi/dtKYo/YPah3WZVxt5uVaa+Gs8ZcVj/WKsatt3fcophPj++8DTeRoQA87VSjC24go4cSbHfiAtt5vzwK8Sb7NTPm+o3oMLjt8r1WqwTPxBCch5HYOQoazXGtBawvTw+didF9s4r/eUX4G2yFTOJUhwj1q00uZ5qD+IDhgh6RmCS9Fa++tipGcE5m3jR+2rha7T6r1GdhefNDyMwQTF5wR84k3nLowfLGOmLe/xBURNafcVU+O/0CB5C0BODkPuItlYd8qv9lTX36yfngZsjcppStrgElcEgjFCS7A8dQW4PbhXY21dJvMkfeE6/BIcqT/lvGYQpqWfeO+++EjWc0PUp7cUBmh+fbJCIVZl/q1PX/oEp3ss2qitxuYp64Gyp1H/43F8qo/uz5F8DwwcqJE9uhYAQfnRQ/zkzNjn+uDTWzv5TbRo8XMkkv8uv+rFfc9UVI0jcZOiXl6soYh27N1PSvvd2Ug65EMGSlde27dxP0U/xYL7Kp7Bu+o1FTb0e4IGc7CowwXK3hGDbdFhjuTrfmO6CA1vv7t1wLtyz5+XwBALEWLbGmGOUCtn0vJCLu2wztfo195WJLu3geK7i81g4tAfY48pZfKce9UtNi14Lxa2rCGYzWmPFcyc65LVxJQs0WzskigBxRKJQxwvNTEynlq9aGYV1zy4dv/o7XVeZaxkV7Mu6ZHK5Xbl/IQ34mOvpMyE2jmSB8lXuMH1Binr51Xcd9SHE5azoiqfeeuJA2p8MdsmnzMz3HXMMFP8G1oW738NkrFkWuNUGdAvUZeZV8OTk6fgLzB8uyufMmt8gBCFvK6OXhEAXCZ7AHkNn+8w/zoTIIbYmtBX4v4Jbj4geBz8bwzudN4Ed7S0AlTTO3RC8+wgWhDW0FvQ0vIWOzONFs6Xm85fLhUxnTdZoY0cwsxEqUoDdnC3ak08gZRVPtDZ7tMlb6UmP5ma3EZ+HxPPDoI1t05xfh7x8QmeBBxvxPxpjSKvTW8wqhn7ctzBhRNgQ7CaF4//HdS4O81cMFkPkfMM3rkcYS8P/D6AIos38Z6ZEtQmc7xV8RO+Y/8OPZu6IeEdDUacBkgMsVC6/gY9NlyNwHFb3o/Si8tfJrqjsEWFD/ks5qhEDO0YTll6zyTVqDvSg4/ZbddIyPe6v9hU+kupRn/u+U40T5RF6BRsvMuqd3AInAiZk7TbqLaLqsVIpS5WVMrmp7LIVj1QiCzR/4jg7Fvrn+mC+7WdVLdaa9vbzTkug7DQSNGqwqXMEOu8OuT8VdFHmF08U8deB2sVdLWeR66HZcNpTeb50hCCc4HCetyiCrmPMY//SlTz92WW7qv7HU3yuu9PIGPHHZoNXUb7W31cLY4FMTSsf4zRE+XizZ9ufH4z1pnz6Y0w/39T/KEevkF06fNvKmPspM2BN6ST0Gg/oLevkvsqzyA2eNeugkQnHJ9c8sVcCntn8ze9aHTN4VWBpvKXNI6TVnOVyLkq0XkG7NIELjfNvkOML5+/a4TMzhuzATEr56L+a/8zk4+yRR7xOcP8Grle0/u/+UeeWH3nr2m391zt73v6sgD3kLjGx9KR3HCpqOw3zOzfo66nNRKI71esmAVU1Cxrde9fX8A5IaDyhQ2GRGC8m3mcW6/fzPAIHCkaWpagkSqU+z4UZszg+/9I2UX0HSAmxUFB/ZwcgWPSIU56WKoAic908ikIlaP3dusEinpxYRBGjA2H5J5lByz8/oXq58nDwwEkFjtJ61Otrb5/3w4+1ojuv+Yq0pHvblxZkDNi4/DhibQdqIkygZ6HichGIRChpG/M4GFA3i2vTJhaRsDq9W2jSq0vBnB9C3pReo57pbPYUzjNJKjLQ+lEwfKhn20U4G3r3HhvYSPGKgxHEQH57Cob2zOXWhJk1UQaoLCja2X6u36h6oHyNy4jZMO5XJ7lXExDJmgSUPTaelcY4iJ0IR2tb9KuexrvFsUrSQl+m9Brsp/DdJ4K17GAqIKxJrWyX/UFOrA8cD7xGZ/HI25/TknX7rXTGJVZ06vTm+XaeCew8Qx5xoM2OXAxaVrNypFvX/a4fDj67bbt5EyHpWUNzqRzaW/bDXblZjN7kYuuNyqMFbYCIZVUrwqMw+ANXKnnCJhJzsuOVxXQnxrH19twGHNOaaf0ic564GarFd/2IEz2sOFGGr7vNYWyBP/sZBi/b/+GNH9218KxRytREDh13pezRNJ+IXOP7ywkRaVttj1BDSuY9Mc7mN/tXqvWXZF2Cu1nu3LZL5+rX3BFqCRQafY1xbo/77WvCbD8HNrLVqJUip97i6rrmSA68PX3+fXeFsPX6Ej9+V68iHIlmz0mQMH02ZuvyEHCn6Jws07SjZ45Lb6YakQOQkK6N6pLqoyMtvFnBSlOGddvgB9xI49DpZA3kPQfgyh+L4yPBQKpjjWhxyoxMpvFlQmx6TxSOvIR/f8FfRfWta5r9aR0Jrnq8I8oIiCPQFyrQw+X8/JYNZj/yEJ72o2jGhqYtNusvknRWgewoK+WB8aaTR7+aaqBADEAfdyo8gTWQ3Akeh4V/l/Q8crljEY6fcUSx9O5ulqw12HoFK6Z/YS4Pb1MaB4Fw3qHhz3+ys2oW6pH73WdH4TT/Kq6qgk788wFnY5/vnRpkenzjQolhW1geqBy+TBt64b+8mi4uU8UaWCeLLqRbrszlTSWGbIJ1X5bZW0j47021f7hiq3VURozl6QlU/A6Kyquv92t4iByyPRIWVXwWKFqeKUNrntW0YZXFtPlU0J8+7BH+4PP7TkZAi7eUpWxX/Ao5UJw7LFU50Q3KY6NvqJmRj+QnkUedc0ON8D5uGaRL45XpUFOrArBVBX2ebapMh0ovIIYrzeSNX9JHkpVy/Jpi+mr8uvN4Nd4ixVA9QmwpClAh++YlHJnXMPjlhd/1bhe8JOj8Gxg7TlL49mpFuNHxNRY/W5GlkJfLHyrtZ5GECQUYI6QhAoMmV0ItshWSdE+sTp/nb80IeyA03Kge9080nxAjUE5b9reKWpBDQscnDzie5hEgDPNKqOjBWGINsyhFWmM1A3mE0qm4jgUre6oQuiE/F86XOPZVGuA+rmxOc3lGhSTyGpM8mfTl5t9Pj3ecPocH88HpPxSQEDYwrvkqhY6mL6We0KFPWYCYkM1RXHEHrbNmdclKZO74FtbNF9hX1A6FZuuZti1X2h/z6bwq16OlMt5Rex3MDuR+xa5eQxFqBplfdWV6ZkSKudHrV/3vf/QvepwlwFnhcycnhWJnp3KlJ7uON3+vXFywEftz794FcjtAEIKjVI7lEtclf+jcOdfkQou8GVG7Tk4znSY2FX80baJ8Nvco4quJI1wHMFd28+96ISd90Vz59BiZ49yMe9GXHq72jY1DpYmvDXtPXTTt8GfcLk/2e8OpRxcYgG2IWaTJcSZPppDrkzEtH4Pk/L91Hu8R8YxbbQUqBJodaesGs+Bb7QEF9c+hPrs14KSx9JQ7ejKGiFxKf8if7dgPsUjFTx6XGA4hgRaF5LG4SIwnsIzlibCnvTiymIsaLaeEXVGpCT2+kGQB5eJSJ1z5nDIKz7BW2/mbYCPz7tnAc9KyocMLwpo5t8xhJph+1I1XGlLqqw4GGez0FYTO+wY23e7wGw7kLpPJuhEYrRMY7fFQp6FAEwkyov9NHamgRBlgJaCYjutiqwWP8ERmFxHyYbFHW7+MVMaAhZTOpjrMVKtqwX1iStqvuCuZJqohFlMfRMq3K4jLuh86ffbtrXE0zQhAdf8QDEwHGJSg2HgF0AKwacM9AMTZKGHRGlUPHT7J3qz8UNevNqiBe+TjRt9L561JsBGcraVMST8lLbNleMKKTqFIoR6VOTOtGnBzuPOhF6N5nK9ORzXeAIR0vc4zaPJ8kd/wd+x4K/XByrtuO6C8XD/szIhoTm1hC0tLb5hT0q6n69p8zKMCKwgqt20aYZpYH4VRYA1UOzmPq52cstK6C0ngb35Lp9/QVlYcfZ3ha6LXZudmAuVAgzuJwKvkgfmV2TJq4aEXyQcVFO+Nx3lO2nCFn1D95nCstkTxwaCYjgV5ZBsJ4VH8iblpkuHaIU4iz8P1f8suFNZp9CV1trhw89dNSDKZTrMIeli8dHJk7GFw8k9FnRmr0/PAQ16gXHlsAqoBMbj1uT4t0o9iGr00tmFDBuIIv3Ua0quOnNzVt5Mt5GkTKv5CAjZiDSueiEXNSo3EG5k9lKM1Pki00TMw2ixPkhYKB3wsJoeapclFQHuI9zQhQYOSA53INa3dAM/KLanXclErko8JQozhZa28eZBptF2Tk6lTevA2drJl1d5DRS04e3StzRybXQt5WQsQ4r4tFJGCJvQsDZPIGm3aZ7Q0yQKFc5cZdKn9X0Byn/Kp4i5wEhL4xRc7k67tR1hqk/ELjoFIoLXzcvYgC9dao6NTisn60DJpqxicRhUFB8Gdg83ocHt+S+gIIw8iQEEkOQEutKsJl8lHZ91tYWf7B3XXPHjBIpJurDtK5knpYtFkIw2n0+S7I1/je0vOOPz6Vei5UkEN/RnzbSWUUHFFK9goVKnk1+eCHi24oHwxTkPc4M0HTQqqHnpjXNEb/zG9bK4Z7/GFIsk9XNSv4Naji2Cgcdrbu4MYkBJ+2KcsJrH7NS67JQT+o9P1xYNVyVF35Q6DneraZYkRjWsru+UpKsxPaYYM43hM4wyxE8mfXKHqASvf62E/jXQ6w+njbZ3p27jw4Srufl9jxde1bWzJAlXVzFvVAmujrzByMd6n+lX0UJHx51BjWcKGGnx4I1pOx0KoTaq+hlqkW/9EKHd74udhBtFj87dd3zZUYbnqcley6/pR+L/eOTwc1V7fvfJ6mS4z0yknrcdHzCzKx/l07GbFE4MZx3JkYgu6AdaU6DgzQD0sV2Xj7KG074IigvN2bBvYKaamMaT2JwahplAdfyW9pcqdyneUFkP1u6kAjVPRfBD58trXGOVj8vPGdFnkcsm3FUkzM7o/lbll05/vjFxMH/UeWivD+g9JkENAbs3tljvURGmTH5PF1GEPXzWufRnIi0VVf3mAHYJNU10JkUO227yduHCVt/5otGTyN6kCPRmTMpbWh2PVcWeG6VFJiOpzZsRlpoumSgs1a9bk3laSFzOmhZocNfsEVrP6u25DIj+xl8ZYCXtuBDUIOPCKvSeES8Gj2rkfLmFXLw9OrJNCHu9VjesF1hG03v+7CyIt87iRLqMcLO/b/SLYxzQvnSqJFz1wCPQGtcoNXHFSiXnav2fCodkiSW6kVP18aKoWo9HVGuLidVy5mfkdi9FFxGvyXOPseibwtQKvb0+dCkv9V1TJ9LHrdeyeJ+yF/qgdCHl3sOP7uVP74PEieL0j0SWUifc3nwsbxM7RIFT0NMVkkNZ0hOhFkWtxhbrC0kVtBSd66ninv+bJk3E9jdSD6G37W25lb1TMtN3Ye9EKbp+5BuizxEV7jw8Y8m9h1dsNfr4gBVqvZ1GcgK2X78WczcMX+qPXSKsbUw3XmtIKtAfy5BsXz2QuqLc50Ert/f64+65/qZll4t5MUyxVl3WdP4prKOaqwnLL7PyNxlu+3mr74lwPsPJQC4OBIacs3aICX7tpXLmPFeOnltqaULnX6Yyps9viYqcht24PiONbffsuzATfJK0tc+NugwT6rYnLZq2uU7AffUULS85qBhsJxNVzVGCz/m8ZxziDC4hmKXK2LAdcz6yOvZTpppoiMc5DRf7O1bzlXuP1CseWdUleHgH2GXtZvOdA3gJjXxDKnlxghIztGDcVVwHdcP2jm6Qp1wQq95GotwkMnmO2C7rEmtn1ZtdYWFwYv2mREOc7JcMJdhU5B3WPjPicV1WQMrAI7TfPFrEnuJ7okvZt9+kv87YTND4ghJNLrf/fP6SQF+ye4QQThgKohKlBOyrTSpvzyEUwluxXlVtDW724cnCN1IPR5JWO9VHjt2Kylv6+/bfM/1y9BG/rFK1s8efcBl0gFjySD7xgp3cFxnmABPmu+egdajpOAOjt13t7D0iQ1+5LGwVPG/4U2q9lp6NMwiwsLhXpteCMZa2vDku+uxkvWnjEJa0tcZ84gwTG/UXM8qZh5F++BxbNyMBEuDynO8Fe9FIiSaSUcUPEI0bRoRZ9osl9tPPL7Qveryxyn0Rg+o5mqdNFvpm8hVuEwHdJM4x916donjKLNSi8U/X77PK3RjpUsN9KWmlDOAFTOq38GtUkZdQAeMvDSx+711HLH5dqi4rXKAYGdOMpaGhTu8G/fW6KSeie1z6JZ6Hm9k3Xgo2tZ0QaJTAXTR+qmxHV5DA11zl84ZBTp+UQnVuRvbqo/iv5u62VzsO90o8wh928wyDza41NfwBntRLne9Ky1RYF18Prs4sKTymr+f3mWdNuw90Xt6ys5TN4y0na5+V1HQNdIEPzR0Z+tHMkzWFTQGWtwU2r/6SSr1pBfGYqGEiezeMfGHjkEuotPCJ/ZNZCY9xyVxM+ZFe5kVD1RZAbKEjmNg1OrJNC+rvTL9873iz8jg768bWtVcfY0d6gKPI6obTpiBQ0/QQ0PCW5d/Bqmrn+PcYZ8/YE6QHPGWb6fDEiWnjj4LvfnCav3kEmlYLI1bb7u8f9tuRb2QxyItHlwVQIX9aLkbycCYjOyPqykyrZjB5ZzhJFn1WxgiWZCUsiyJh0kyyl43iL7smFLzXNJJAXXa7x6KurUdOw41JSvlAPnnRT0fvLtf/nXYA3AyWq3a9GmTqcXGeOuzfIOeAJlcabXGirT0Zbiv0l36qjNW62TC3w25nsj8JiMHKYB4in6MwBe+iJxOcqc2KiP1WfIWX9vzKCdo/f8In5ulG+LKkvrsuR/O3ujJ4zYTJPn5hDuS9VdklyLx2j7qCPGYktKpWmNHE9Li9uQ2oydAYGxDfZ756LQ2XoOEVZYau1gaF+1Rff5JmfkCAfB1hYQBC+lUR9CmEKS72bPekAf8gUr3z28F7dqfbl1YqXWNXmA3JKqZpPr39SwyUopzDntluycZCytQB1i9xMfuvr5G8kvFwLbKLiYrzjbRy/HJlyMPiIab1mO+hdV8gZ9e/AURtART9+5ZnucqgBVla1OBrwsXJ8NFQ51DdQvL2zz1WdmPDB8Ym7a+lT5lMX8GiAIsLwi3FerRPUxAkOBYI4MIYn+MiHwSDoYfbffAf9bk+nIPQg1Hz+byqWzi3uXK7km3M+AaJmqPidABbcfTgPFLXbm1USSLCMRB4HWkiB6oVXJtOd/XxIZJwwaxxy8JXSQWoYSw/DmtG0cvmO+qnisTAhSIBL5fy2y1REfFtH3kSKaxxy6wsf18xR5aNV99pk9ce35xqgvdSmJzdyls8pr0lTtGA8AesX6bNXjqFuSkKsc2MOwZSeJ+bkj9VeCscPWLps3qodeMNcZuUuMTzVtXXf4jZsWBHbiAcbvYpZ4864NDgN4rZNeKJ23y229Io+MCtKdbc/z6ELpnyXuS6hLvuOw4mO/tqjxQkvkMBgkj7lu4mATKZ4skZ5kiFizf3y9ivzqKoiWcpGuvARwpd177lQuc3KhkJK+kupmNI5/ZNvck7rOyujCyFyT5efhT7etkOLy0ss8YtsR8evByhubFmbW1HcHcmnQgLLKcLSyVwdreS3XTPZ4Cd6tkZlbGjXBtrI2UKAgD0mDi83VurfRxEv/DgfmyF6vBbpqXQXL6jHN5aO0drHvjRIn0iZVbZ+6bqn9DuNMi8qHyCoOGahsh99b5oq006mYmcS6EcII45FhYRJyyBJQv6Uhb52Dx9+SnkDaWgaiYArDfQXT0llMr4dMldMGK+u1c9R2tkzA2qX814Htd9XKWi/EwNjJN+M5XqBPjuvg0HRJFJLTAKnA3J1+W7SVYrY+IDw7NsCY+9lzgf2HKprbfZEUzLYHOneGfXcOTfLkPytZzFGqdNtXtnKoVDJ2tIpaOMbMvA+GIQwTFxR5bEvqgPqzmw4eX6VyfalLOST7fwdUbquFgrvccssr0AJFqYGRdenoqzFidPDj1iGYVKQMkjRnNy3ahIbqLHinxXsOuSS3f2PFzlM+d3gAPjy+McXnLX6aYC/DBlM9uljuL59ZVVkKubmnrGtRm0O0y3Ez4EYUjv/p4XmbH4+1PTCRXXU04Yj07Ltj2GvT/lR3NNXNIP34R+jyEjbUrL+IXOIz4F/TENuIQZqa+JejLzqVlNrAPoyL0EKgXsoQhNd8sQiCGnZD9AKOjJDvnL4tmtOXrvDt06bT88t2w9ULZg/SNYqyxjlEilNcYCQN08q8gXen5KjbhepdxiCDTm501kNsuuzb4aZjjxA/DYQc9WmHfTXjj1CRr3HNE4RpbrWjfw2tNXwu+YuyPjhgHkCLmTMr44vnTUWkcVHuTV2+mf3NLZ1pdWXckaQljE1785Gr1Srm2nUKkqZkNtFN2t/LNDtoVnst/k1kzDZvcCgMMqaDDYyvGJ83uz0pcTG+RfXUumDDdcX0bfvivHu5Ee4vr/2C5A0xFjPV5m0hZydTV+/C4tmoB+qOUsAGDR3f+BBR0aIrNRElC/21wrncS1h1hpaaBy0ETF3+/XqzZ55jNgAy8DFu9UcWmNOEM4rQ8i/plpMqliiSaH6JlNyesuUEu+rXREGOnKamjndgpp2XJMds4deAC3QjLJkZn22cmPkLS+9iayL743vXQdiBzpCmGIaKiCY3Soru4oSKbsnSVoW25ySzvP3F6OsIY3Kjax30tnW9Mb9JR+ZhR/gPqLfikhXKuaVd1PNG9/gRPjG3thO+BgTeFCdWPbQEbFyj9Bn6eF5QLPUoJPYemYy9cOCSQ3yLd+wy3lqUwemxNs2INzL7/P91mR/Nrfa9T19b6pRyMZjgkJ43WoZlKKnf7z7JCfoovR1QTJlJerXEZgX4ZstUqtuZMs/FZMDFChqttGuB9aTo9QPVr6wpQQeT4uezvY97bXIpe0CYxe/jmPDtDXGnLi/4ulPPYrZnsZjvOjhxj5m2nLvPpmohASoeu+lhKn1+vSFy3148JKVdROM/f3KuOhGjNOP6kQX/vLGa3Fi7wAI61VESU9fLpMCy/sbIXcQdGpYM3kdGCvr4D+P8+Vjsm6+2yxp/9EeiLkHTp9uHFG7Ph/9OLj8fvfsTcxXPdpjXbMho/BXZCKldxC+/KdOjunYFPJJpP6nwIlFsJd/lRzvn92F3YgdsLh6+sny1C4PWnexjUWnjrPcjlSXND+V7V36M0u3aoZXS5o9CoWBoDPXk/PoO64njJ+ewFh1Axl7nFhNY16ejR2v+6wtMih+JECc0aha/9GbV/K6sG5nbxCKeEQJUXjMcWEppnP68UOcxSMYbftpAOdbkbV9/fsP+y73spv2zUDL6+uV93WtMBfddbETdp6uFqHfRzKIUqsTOHDzq5fgeUtzDRCO5uoHWba81N2CEK1iluPkreUHw2ptg0tojme7kZjzSvJZeyfXhm9kQxTuIJzH6o/G5H/84NtcFqV5TIxO5Q0Xf+gsN9WLYc2xzsiHqhTUJtu1P8P9q5cpmq47yUjL6NsVg82X+gPCKSszDiYZivfOZ54FaOjfwjLou06NUrxvmvIdGc5quimPI386GPcUhLuDBSjRLtdxxLbjA93vf8VEgBnRT6jxhSTWfq3M81yi4f6FrjZm026luyhYwIYDCHfPosLicrzOKdN6ye+lkD95Ij21yMhKRbLn0CQ4OpFTx4IxMJ9VIE8GajIdmCFUZVc5+BbYCmzwLevkeXl7mJZDNpcyQ/5SHFXPrEtlGOzzve+fFz+h5cFdpmX20sqeUMUQQsRyEpcKjJa7aW6iqCApQz+qk+De3+eg9aWNIfbDVbiN8OuNRUgId3LIqOaJ1Zbj3/ozKRAYC5+R3s4mcV4qduihOcwq/RxB4yeG6IjfOK8jESFZ34NoQ+xiy7YE0zc93hLwobWeWgT+BmjFOpetiMner/qvmPWghur4jWoiE2Yna9DYQ8pMewN3uAH1NN5GMV3Vdx3Ni46Fsvrb1nHo4HrkkEVk7KRlXJ88Azl/TKVUZza3TWuGWLGZ3cqk7BmwPTNa9ERow1gx0ihu7vLbkMi+2AFW0xOO8SHO0lsS3krpKn6FE2u/EkktQEjI+ObWznQTSRzm2WNi8LDatddsmvcEP4Sbd4ZH1C7u4Iakpbr923nyABDOMjJ8Pj+Lja3K+AXUqszW5pmqqtOSc+DHv0YKsSM3v8eRMgN4rE+UvvE99ufhMvWkZf6kYW1ttJ48T57eYeHnv4NKaSO9mg+T3AYbqH/qeD+7ObYvunrZTl7X9s+ft7FzPnmh9VL46uMijvp6flA/OV1LYNbSxrwyieCjX4avGV9Ycf0alL+vHd4KXnrozoVm87qcehx07u7EneZUuMAJES7Nxog/GrEdFuM0vMGwbMWVLHMa5hJr5XeW4sGB9rtXAyQEbUS+NERwKEaLWfaCwJU5pZgOB/a6IQ//Jm0uIduszKcCU2SlHlnQwvU0bmwM5PkFdcoIMjd1ZPpM2HRydlXLkP6xr3STYDlQPW1GpXROkd0CwZN+bfhnu8nw+NkV2vixsoWorjrErYhxHkhURFp+P6Tg+/X9N7nfXitTBxgr3LDl89Jsyj/UoIoMQ6z6j7oNLCY7mWictUMzMdBxp9CuF7hKNpI9T3oqE4qGkCymI861GEzDXw/Qw+Vc3vL0yHndgh8/OomEuUQ7/LJ79klrxh9GY4IQlrYaDs67xBoaM8PDfwNuzZwnvtl98ScKbMYE8TU8DlNaCgDBM4a9DHKlQVkON5sZmoQrziOPvCuA4B+SMGS1ixd4BJsJrxZnqIrb/b37zx9ERw8ri3ztLI9qxxug5kB4V5GdhL5nSB1xiulfCBIF8VGaxL6rRjT6H5895UTnwf4hVEM0m/5zegue65/A6Y6WR0n9LsUUrws8wPx3RGdZP0zkCyp/t+JcjdXmQvvlpjTd9wx3TsZM+YZL0ZftADFvfOJPbkT0gRNCw4WWEnVefEyL77ZKhpoEv4osIjmhiJ1GNZOVAmYUNjhffM20xv8gjvIGtYl5hWQCflN1uP30exwfms0DZsvv30PjQ7vZtu/muUS0ndhwB2UzR3cp1sMYi4kDp2vgZ26e39vHbKw0XXKld7lzAxgPMw2soVOgX6/Jy6O0dPUADJ7eWjzftv5MTIg3NG99SXT/NBYi6E9XSL60BQoTzIGUseoCacvA4qf62GWnFbVlEnEicvCOKK3p25gZpr08RpE8QwpE941Kp9Cf++9PgorHbUkRNfdFXaGcTl9ihYtZ7pr1Iw37Eu2JcrHQ6UADfrr3I+KIjisHOQ+z+TcjVUPHG49geJ2XDdPcKO6m/JYpMuK2tjxMy283gabEoL7ZRky3xsn4RTQxhEUdFkDhpZ5+1AL/rQrTYTrj/DUNNZZDf8nueNFvyU5aKNXa78u0/Gji8LBS7OshC0hok//S+5V528GJ6D5uvGJZcUFWzHRgeIVrqUNKmI6VjuwN2c0pejYgrHsK/cJHFqygBmyMqrAtSLqI5weTEGiQ4oQdmlf/Vd0zX7dj55ms9VGuqfG3KdNKT+J6V8pV9SGBez1L3hDBGyaTRPxR/IxlCYlCKG7zIZp4f7K8EbWAviZwOpzggmqEaXpl+/NWY8uTn3hItSrsXtXwOVfTzYyUu1FS2a2PgQznL6ys6NX//cwpSsX2n1+VVE7rKNOcPVkQm0cmiS+yHpEgjnI1Vh01aotsEoPxaSHCiIFnm+wSKW3Sii9vXsw83q+WI42/wdrv/xlFaJTLdn+4lILS5CIhELA18evf31MqutLs55ekUJ5AhAm86PpmzpOMlZmd96hp+1TEoxz2EeP84j2stalg3MMiY/qNtCcfkkjdPEHzqDERg2rrozVVbNirShua3N0nBMFdZ7sXFjoS4+sbyxvkr3qzyDf21dYS39dEdHfH8YWAENUux17R9sKlx45pZru4G5AyIRl7IFuQmAdsrTIiS6C9LKjjG+Rz1vrD2SejNxDLpHdEGP9Ova5xUgXhTutlj0hdc6TELSeEn3g4Q1iP0Z8qe9lKBr915v9+w0ZHd/PRQtN9xsLJqhvWoYralNI0EzjH3Tt+didD9M499uymaQNADeq2IkUm3bJJU0pWcaCDZ3qawqmn3PmUYLEecqC/I2lO3IgLRNBCMOovNVClkBdwwml3BT3IrSQVmGSnX1RKOovJvOEp49YPYO2BZuIiKhlLG97Py7bqKta5RwYf4kxt5zlclIPGdl+C4B+q91sNT0uemDNBTcwTgud3/cNvx70ZGQ13xEvqq1iwzn5NEwmH88Gvvza7TgzCBNh5tNRgmrC8dScblVrtoOqNMxIwtoXycDilQT/qIKgc74+0ybaqOCOJK/mrF9d7cYO08CIWDxnVhr18QpXE0Eg+oPQiaDdY4PoIN77HVZDNDe+uDdbtt1geNjQp5Lh/R0ZnaFaq/lJBP+7qGR9YHPLn9mBh1MC9LT+wCREIR+lYvY9q98RupAQ5SlLlO9sv+RwVJagoS0mPNdGBLpp2gIr2K/owfloxuZ4QUSNlKE0+UM3BUmV8sF7gF1WZzrtlIh9drx3Xq2dZHOSicJcVEQzGYhn0xn1Wb49OnYRwg+D9z4S0ycuFnK3nTYfD6nmxHi0IbXNlG2dRseOJGTrElp+yPxqbHrNa4/QUpiOhBJDBtY94IvXu/lW76o0w9TWQrHfj1Chs9llXYzrpph61X40etWn+rucpoCejXV/OjDo8XlrqdNp/OiZ/r6dzCtlc6CO3rw2HbDENxN2nq1NbyMP0zYp643CNlq+X82sBQgLGHse9x6boEJWjVOAlDcEtwoGTyJJ6cSl8487sW8weePi8GTudQUKM1cm8I3xprvz08DRjmFoLOkHP/las4RK7ICQRIt9feB1MGtanQoAYh2hncAL0Rjm8+h5+QIeZNJqE2Gi1yON43LLleKMBpw3y/p0yu6sz/ji+04A5YT4rZdEUkqPOEc7hT1eynD8SgTFje5FcuCAvo0dPWbHFoqDEoLBoCDoZJ/QrKOz8I/6B3/zI2aeeAuEN+VPebcZGOPIoGABtsKQwm+Qe9at3FFoPOiVrKdhbW9gn3R2v8gpd5ks15Ip8j1BhBI2ciAU/NY7uGSuQ5EK7MVD/z285n0TnFf8yRCOt3/nn52N/zc4ruWrgmvYWwsB9lCYftnosY2amPEUTIGXmKgW+drNPapWkTLaP9IezwKuMuW2tnX8qHJl2j7+lNwWtkk3Zo+aiywjAsVQTSl2cQuvouSua177ONuSQMouaVosJpeOWxM1RmcWVmAS85M/tO2xe0+cNkiJNkwkQA01YA0mgm4PZ0qeCikevIGUoKU2AZybtZMkor4PTs5AAgeTLKcthc9rUWDAFOZmWrQ/oWk8rpeaNWZPcLLN34NP5JFJEkh9qb2HNjtjkZszBWlmrVUIQz8FV6tjs4r7MRVJKk9DMn/SHKyhPxg7DEmMN2RrKx/CBQmYhcY3Ymk6CYGhxgooZl20wqc6g8AUBQir/xfb3YyzpnXLPlHvFqMl7NkO734veIgsWhhgY03ezxaEv81X8HEIbeH3yXEqmowhBSKL6Wlqpnd0uJ8dCbuTFWEBXoypsJYmqc0Uiz18IdETNMLc+Q7hwLjc+NRkDKSvoAdgViWcBERJfEDDWWt0Fxx9oh0afGt7cfkiAkCO1Y3P0CS9Fb6vvqILgj8lrxaQevxybhCjCDbd1jdi9wrDj5RofyUFOpLErZyYt7JCyJcosOpa6zTH3+avw5ohMDD8bAz1dJl1qvzv5IDP/XqDN/UBJ0A2qHou25hY2nIqBO51lIAm84Zgfxc1cSNI9kuMe9HOLj2oi/2Iol+nOZ91bd5IeLHCBDn4kS8i8RbGrmPkzG2VhzKLSWlTcL0a4fYukRZxJI9k+AC7h/4OGBqKt/tELBAfhHLzMvtsqH1gZc33hQtT41qqf3xYqqjGeO1ewmXv+3k7mqZ7BbAGE4xcEQZeYZqpsCsN1IJAsxgjM1PNx/fY0bApKj3xbT8aSFpLXpAG7fOA/vhpqcVn5e57tRpsGASIE9DA4vdbJZTLxaK7Y3agYkCGkNIyt99nOG6RPIsKMalstVw+U83b9cU35Wy9sKyZCZxqPQYJrLyaqwY/6KCVoIWVKJquMkebpHJXc08pL10YyyprgwgR9syjJN0il7TfIr39fCIAqqCesosYysiaGytkl9I3nzRCY7KTioohhuarB84vui3Fagoq26vyANdQnrTjNeabLDhNDR3AXePtt2R9yefyexoGaDutchRosQWOshaBXAfkCbx7V8oYlToDxlZwVQlGgMKyPfX1sEroV2L5DqfIRjFgxG/YsaYjqrhm4PAp1IQYhvXeo1Gw1altPBw1gbx0Wm8WxRaUXa0VSKiO+xlVFa50pfJzJmhzfEj5QsFTQG8+bT1dYtyWOCNBrdBDw/Oxlre9IdRDxC3idlC/yciihd2UU9ro+6xUBiBbKMNXQ8afLJ2HdS3/YMEIAatLfsKh2o2LHObmlkR9tHbx9HJfFkFo3JHFkipR75FNx1mkJ4fC4jTj0LfQ9agAUKOwS7ZRVLSErh6srIvF1XpO8uaNkryBUb0GRea98VUN8QP/vjri3Mgjyh3pizi5dOq4av3eOazZ4i2FSM8rWl+/PSKyhvWpMDlvrxcm7DtvuX4lx+ibszu2lB1OqLFiCzOPmJGSyxmq1i7gQRzz7A8iVmYrbm7PGVzMXO46MI1XG00vO2oYORzMMB5JgKoBoZW7dEq5YtE7AAEGVrh81UqJ7460V9a8hZV9h6aoiZMaN2DnuBy8V2UW2VT5KgU6mCblwvuHG3OjhnPocps1ctNLPw8a4mUBhxKFlVPgVpoYv7zgsXNhXDwhFJKSshlhoi785Fk7bLXl5tGW3aV3BvbuUCv+AC61kcmt6yKF5eJH87ekjAsQ+2O2BgFN0SWFrQ+wto3cH2CKS/pgaqqE76Fxf7bc/V2Jy5MOqDBwfpThy/uJFxH9hdlbgLwEh0jJiyzQ5684eWFsiVwJNpBy/2VWUJ9IPaXwMBUlRSOebBwflVfBDTZZT/PDmD7eYFETuD4UOWxj8HIopkdBpVXLG9Uz+DHK7DGACCVEXe5d6hI77KGZd3ARjpziTfNkmRfHJ3oq6Lmc1Sq1uwR+o0sPK732oYWkQ+ubeLXEIBkNfpqq0aMi4UAhfEK4ehfrwgOAKS+XefR4eq+Lffq/GHa3XmMm3fnJ8riENDy49P49eGfmigad8mYo5+qY90lrfP1rxU2k0pb1CBZbwA31DKnep2Gbb/++Aj9WWFAvO0x+5lv2R7Wqr1AV73ohscbEIztPnBkPvp2JQW00bqX7TZJM4GlPAq4TaxfEnAurpekk5Z6B8fFnDXdOhQmENzZbTRt4PNTSXJxue0vpDgEmOIdoXfyRuZCSFf7JF4lu7mAFwS6xe2vrkA3hwTLo2Nm9Naf3EsavAsiyfxnQjFpMGxp43eEuc4vq9owm303yO81i50IUHJeM+Dr6FHCcsmyca1Pf9CRYeR3/Bl4SAoRO8onPv/TYNFqtQONTGkQpeM5EAMfaQVf6Y5PTlp5rthbBnlqxxfyWJpaD33eXMj0tJwr8REoLPo+KTMvlDQrTQ22H31WBCnYY7M1/U0i2jmJLXIIIa+gUvRhhdhgI7xiAcTyMxWMnFZJe796oKo3rOBp4pS03gTevqz90Wxyusu82LtQK+eDBeDCpyfahpgXv8XHyNLKvnAJnLn7hdW2nZbe0w3XrQZQCGQjh3eyQtsr4wR3vzBkt6E6aNn5AA9fO+hZ+Lvfw3ZSOaqlwzTtR3YofE7nvL0Yuhn2oUDUNVpRSpCMFKyRjFT0dhzDI6L+O/6SdBmoNmKQGtkOEKS9oLfgXxWTYodJT5zxkVfrZaq9rkB8H1pyoqGC2UUS1Xh6eGh4r0hGAtqoCvO02WBy7zwddEP709a6TeCJmOV9m/BghywYn+6wqHb9tD1w7I9apPX6qZEQ2n7EmtXfHRE4G80js7TDRJn6GE4EEuNG9A14fWvA/8LCSJB9LeoRFyqJVWkvtxfS1rr26WafxSrCje+hX0CgnP40ZLnweXcQa58P30xtYzEQJe9A4zR7CfOlXTBbA0xh3ZZsCjcsL+9BdsKoJGfk+2vJdrb+seBhLsghkIh3tXN1WjBx9hojK5GOG5yJ3kLumF/5gcGYGUda4ECLWf24SCw7PzJ+MwfFQm1uyKes5l4R8b8L5fyUnLgttDw/H9XrNpP9SUK0vulw/CccTpZNIXhASevjl87+MJQBpUDFONVnazyvvFriljmZipea2pGGyVhHm/1ZZjZ+ItQ/s6FRjc5m+92wgh5vpqbYiOv/w2hGO3Enx8PtgyX0dY/g+1Jv523PJ5vSb3e6uvQyHJNGRtCi6Wy9RsKj+UHts51dKjBIZmUge4cZzduwRai6FG5yeyFSLY4FqfcW70HXRt6i6lbr5YX/CrV3Coykcj0MlU3d7+m7Pnb4+n66LB2C/fnQL7jpPbzfJrS6TKJtOABeEN8xs2vpnM5ifFg6g3Bh6BoacsoKFqc/iWTdNXQFNbcpo//z3hxBFHgEhbEcFy/e/ZJ2AQJIDR1Fb79yiTIAhslN5mEvfvwSRCMKSMgE+M8t+jTFUQqInpla3Qv2ejwFAONCinQ+3fc1U9XCow+7O4mn/PVf2fA0KU/wn+T/D/l4J/PHkhSEBAcvjPuwD/9+3+P8H/Cf5P8H+C/xP8f53ghWsiQrKkZMiWIj8B8NFU11UrfwCL/H8AHhJPkEVHAAA=" | base64 -d | zcat > ${INSTALL_DIR}/icon.png

chmod +x ${INSTALL_DIR}/launch.sh

# Installation du venv et des dépendances
python3 -m venv .venv
source .venv/bin/activate
pip3 install meshtastic paho-mqtt tk cryptography folium
deactivate

# Fin de l'installation, retour dans le dossier initialement actif
cd ${OLD_PWD}
unset ${OLD_PWD}
